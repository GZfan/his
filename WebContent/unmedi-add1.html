<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="Bookmark" href="/favicon.ico" >
<link rel="Shortcut Icon" href="/favicon.ico" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
<!--/meta 作为公共模版分离出去-->

<title>现场挂号</title>
<meta name="keywords" content="">
<meta name="description" content="">
</head>
<body>
<article class="page-container">
	<form  class="form form-horizontal" id="fmeditembox">

		<div class="row cl">
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>项目编码：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<input type="text" class="input-text" value="" placeholder="" id="username" name="itemcode">
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>项目名称：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<input type="text" class="input-text" value="" placeholder="" id="username" name="itemname">
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>规格：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<input type="text" class="input-text" value="" placeholder="" id="username" name="format">
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>单价：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<input type="text" class="input-text" value="" placeholder="" id="username" name="price">
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>所属费用分类：</label>
			<div class="formControls col-xs-2 col-sm-2">
					<span class="select-box"><select class="select" name="expclassid" id="expclassid">
					
					</select></span>
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>执行科室：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<span class="select-box"><select class="select" name="deptid" id="deptid">
					
				</select></span>
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>拼音助记码：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<input type="text" class="input-text" value="" placeholder="" id="username" name="mnemoniccode">
			</div>
			<label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>项目类型：</label>
			<div class="formControls col-xs-2 col-sm-2">
				<span class="select-box"><select class="select" name="recordtype" id="recordtype">
					<option value="1">检查</option>
					<option value="2">检验</option>
					<option value="3">处置</option>
				</select></span>
			</div>
		</div>
				<div class="row c1">
			<div class="formControls col-xs-2 col-sm-2">
				<input class="btn btn-primary radius" type="submit" onclick="submitfme(event)" id="newbox" value="&nbsp;&nbsp;保存&nbsp;&nbsp;">
			</div>
			<div class="formControls col-xs-2 col-sm-2">
				<input class="btn btn-primary radius" type="reset" value="&nbsp;&nbsp;清空&nbsp;&nbsp;">
			</div>			
			<label class="form-label col-xs-5 col-sm-5"></label>
		</div>
	</form>
</article>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script> 
<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本--> 
<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" src="lib/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript">
$(function(){
	$('.skin-minimal input').iCheck({
		checkboxClass: 'icheckbox-blue',
		radioClass: 'iradio-blue',
		increaseArea: '20%'
	});
	
	



	$.ajax({
		type: "get", 
		url: "expensetype/getallexpensetype",  //提交到的url
		success: function(data){
			if(data.status="OK"){
				expenseclass=data.data;
				for(var i=0;i<expenseclass.length;i++){
					$("#expclassid").append("<option value=\""+expenseclass[i].id+"\">"+expenseclass[i].expname+"</option>");
				}
			}
			
		}
	})

	$.ajax({
		type: "get", 
		url: "department/list",  //提交到的url
		success: function(data){
			if(data.status="OK"){
				department=data.data;
				for(var i=0;i<department.length;i++){
					$("#deptid").append("<option value=\""+department[i].id+"\">"+department[i].deptname+"</option>");
				}
			}
			
		}
	})
});


function submitfme(event){
	event.preventDefault();
	var depart=$("#fmeditembox").toJson();
	depart.id=null;
	depart.delmark=1;
	depart.creationdate=getCurrentTime();
	$.ajax({
		type:'POST',
			url:'fmedicalItems/insert',
			contentType:"application/json",
			dataType:'json',
			data:JSON.stringify(depart),
			success:function(data){
				if(data.status=="OK"){
					alert("插入成功")
				}else {
					alert(data.msg);
				}
			}
	})
}
function getCurrentTime() {
    var date = new Date();//当前时间
    var month = zeroFill(date.getMonth() + 1);//月
    var day = zeroFill(date.getDate());//日
    var hour = zeroFill(date.getHours());//时
    var minute = zeroFill(date.getMinutes());//分
    var second = zeroFill(date.getSeconds());//秒
    
    //当前时间
    var curTime = date.getFullYear() + "-" + month + "-" + day
            + " " + hour + ":" + minute + ":" + second;
    
    return curTime;
}

/**
 * 补零
 */
 function zeroFill(i){
    if (i >= 0 && i <= 9) {
        return "0" + i;
    } else {
        return i;
    }
}
//把表单转换出json对象
$.fn.toJson = function () {
	var self = this,
		json = {},
		push_counters = {},
		patterns = {
			"validate": /^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,
			"key": /[a-zA-Z0-9_]+|(?=\[\])/g,
			"push": /^$/,
			"fixed": /^\d+$/,
			"named": /^[a-zA-Z0-9_]+$/
		};

	this.build = function (base, key, value) {
		base[key] = value;
		return base;
	};

	this.push_counter = function (key) {
		if (push_counters[key] === undefined) {
			push_counters[key] = 0;
		}
		return push_counters[key]++;
	};

	$.each($(this).serializeArray(), function () {
		// skip invalid keys
		if (!patterns.validate.test(this.name)) {
			return;
		}

		var k,
			keys = this.name.match(patterns.key),
			merge = this.value,
			reverse_key = this.name;

		while ((k = keys.pop()) !== undefined) {
			// adjust reverse_key
			reverse_key = reverse_key.replace(new RegExp("\\[" + k + "\\]$"), '');

			// push
			if (k.match(patterns.push)) {
				merge = self.build([], self.push_counter(reverse_key), merge);
			}

			// fixed
			else if (k.match(patterns.fixed)) {
				merge = self.build([], k, merge);
			}

			// named
			else if (k.match(patterns.named)) {
				merge = self.build({}, k, merge);
			}
		}

		json = $.extend(true, json, merge);
	});

	return json;
};
</script> 
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>